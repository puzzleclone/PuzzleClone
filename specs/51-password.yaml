variables:
  p_num:
    type: int
    domain: "[4, 6]"
    diff_factor: 1
  p_len:
    type: int
    domain: "[2, 5]"
    diff_factor: 1
  names:
    formula: generate_letters(p_len)
symbols:
  vars:
    source:
    - names
    type: int
conditions:
  domain:
    formula: And([And(v >= 1, v <= p_num) for v in vars])
  extra1:
    source:
    - range(1, p_num + 1)
    formula: vars[names[0]] != _sym[0]
    desc: "{_sym[0]}不能为首；"
  extra2:
    source:
    - range(1, p_num + 1)
    - range(2, p_len + 1)
    formula: Implies(Or([v == _sym[0] for v in vars]), Sum([If(v == _sym[0], 1, 0)
      for v in vars]) >= _sym[1])
    desc: 如果在某一密码文字中有{_sym[0]}，则{_sym[0]}就得出现{_sym[1]}次以上；
  extra3:
    source:
    - range(1, p_num + 1)
    - range(p_len)
    amount:
    - '1'
    - '2'
    formula: And(vars[names[_sym[1][0]]] != _sym[0][0], vars[names[_sym[1][1]]] !=
      _sym[0][0])
    desc: "{_sym[0][0]}不可为第{_sym[1][0] + 1}个字母，也不可为第{_sym[1][1] + 1}个字母；"
  extra4:
    source:
    - range(1, p_num + 1)
    amount:
    - '2'
    order:
    - true
    formula: Implies(Or([v == _sym[0][0] for v in vars]), Or([v == _sym[0][1] for
      v in vars]))
    desc: 如果这个密码文字中有{_sym[0][0]}，那么一定有{_sym[0][1]}；
  extra5:
    source:
    - range(1, p_len + 1)
    - range(p_len)
    amount:
    - '2'
    - '1'
    order:
    - true
    formula: Implies(vars[names[_sym[1][0]]] == _sym[0][0], Or([v == _sym[0][1] for
      v in vars]))
    desc: 除非这个密码文字中有{_sym[0][1]}，否则{_sym[0][0]}不可能是第{_sym[1][0] + 1}个字母。
queries:
  q1:
    source:
    - range(1, p_num + 1)
    desc: 下列哪一组是一个符合条件的密码?
    opt_num: 5
    amount:
    - p_len
    init_cond:
    - true
    cond: any
    opt_formula: all([get_value(_model, vars[names[i]]) == _opt[0][i] for i in range(p_len)])
    opt_text: "{''.join([str(v) for v in _opt[0]])}"
  q2:
    desc: 可组成的密码总数是？
    ans_formula: len(_solutions)
    ans_text: str(_ans)
    ans_assertion: len(_solutions) <= 100
desc: "一种密码只由数字{'、'.join([str(i) for i in range(1, p_num + 1)])}组成，这些数字由左至右写成且符合下列条件才能组成密码。已知：甲．密码长度为{p_len}，可以重复；乙．{extra1}丙．{extra2}丁．{extra3}戊．{extra4}己．{extra5}问题：{queries}\n"
